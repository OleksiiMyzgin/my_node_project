{"version":3,"sources":["../../../../public/javascripts/modules/typeAhead.js"],"names":["searchResultHTML","stores","map","store","slug","name","join","typeAhead","search","searchInput","querySelector","searchResults","on","value","style","display","get","then","res","data","length","innerHTML","sanitize","catch","console","error","err","e","includes","keyCode","activeClass","current","items","querySelectorAll","next","nextElementSibling","previousElementSibling","href","window","location","classList","remove","add"],"mappings":";;;;;;AAAA;;;;AACA;;;;;;AAEA,SAASA,gBAAT,CAA0BC,MAA1B,EAAkC;AAC9B,WAAOA,OAAOC,GAAP,CAAW,iBAAS;AACvB,8CACkBC,MAAMC,IADxB,uDAEcD,MAAME,IAFpB;AAKH,KANM,EAMJC,IANI,CAMC,EAND,CAAP;AAOH;;AAED,SAASC,SAAT,CAAmBC,MAAnB,EAA2B;AACvB,QAAG,CAACA,MAAJ,EAAY;;AAEZ,QAAMC,cAAcD,OAAOE,aAAP,CAAqB,sBAArB,CAApB;AACA,QAAMC,gBAAgBH,OAAOE,aAAP,CAAqB,kBAArB,CAAtB;;AAEAD,gBAAYG,EAAZ,CAAe,OAAf,EAAwB,YAAY;AAAA;;AAChC;AACA,YAAG,CAAC,KAAKC,KAAT,EAAgB;AACZF,0BAAcG,KAAd,CAAoBC,OAApB,GAA8B,MAA9B;AACA,mBAFY,CAEJ;AACX;;AAED;AACAJ,sBAAcG,KAAd,CAAoBC,OAApB,GAA8B,OAA9B;;AAGA,wBACKC,GADL,oBAC0B,KAAKH,KAD/B,EAEKI,IAFL,CAEU,eAAO;AACT,gBAAGC,IAAIC,IAAJ,CAASC,MAAZ,EAAoB;AAChBT,8BAAcU,SAAd,GAA0B,oBAAUC,QAAV,CAAmBtB,iBAAiBkB,IAAIC,IAArB,CAAnB,CAA1B;AACA;AACH,aAHD,MAGO;AACH;AACAR,8BAAcU,SAAd,GAA0B,oBAAUC,QAAV,kDAAkE,MAAKT,KAAvE,mBAA1B;AACH;AACJ,SAVL,EAWKU,KAXL,CAWW,eAAO;AACVC,oBAAQC,KAAR,CAAcC,GAAd;AACH,SAbL;AAcH,KAzBD;;AA2BA;AACAjB,gBAAYG,EAAZ,CAAe,OAAf,EAAwB,UAACe,CAAD,EAAO;AAC3B;AACA,YAAG,CAAC,CAAC,EAAD,EAAI,EAAJ,EAAO,EAAP,EAAWC,QAAX,CAAoBD,EAAEE,OAAtB,CAAJ,EAAoC;AAChC,mBADgC,CACxB;AACX;AACD,YAAMC,cAAc,wBAApB;AACA,YAAMC,UAAUvB,OAAOE,aAAP,OAAyBoB,WAAzB,CAAhB;AACA,YAAME,QAAQxB,OAAOyB,gBAAP,CAAwB,iBAAxB,CAAd;AACA,YAAIC,aAAJ;AACA,YAAGP,EAAEE,OAAF,KAAc,EAAd,IAAoBE,OAAvB,EAAgC;AAC5BG,mBAAOH,QAAQI,kBAAR,IAA8BH,MAAM,CAAN,CAArC;AACH,SAFD,MAEO,IAAIL,EAAEE,OAAF,KAAc,EAAlB,EAAqB;AACxBK,mBAAOF,MAAM,CAAN,CAAP;AACH,SAFM,MAEA,IAAIL,EAAEE,OAAF,KAAc,EAAd,IAAoBE,OAAxB,EAAiC;AACpCG,mBAAOH,QAAQK,sBAAR,IAAkCJ,MAAMA,MAAMZ,MAAN,GAAe,CAArB,CAAzC;AACH,SAFM,MAEA,IAAIO,EAAEE,OAAF,KAAc,EAAlB,EAAsB;AACzBK,mBAAOF,MAAMA,MAAMZ,MAAN,GAAe,CAArB,CAAP;AACH,SAFM,MAEA,IAAIO,EAAEE,OAAF,KAAc,EAAd,IAAoBE,QAAQM,IAAhC,EAAsC;AACzCC,mBAAOC,QAAP,GAAkBR,QAAQM,IAA1B;AACA;AACH;AACD,YAAGN,OAAH,EAAY;AACRA,oBAAQS,SAAR,CAAkBC,MAAlB,CAAyBX,WAAzB;AACH;AACDI,aAAKM,SAAL,CAAeE,GAAf,CAAmBZ,WAAnB;AACH,KAzBD;AA0BH;;kBAEcvB,S","file":"typeAhead.js","sourcesContent":["import axios from 'axios';\nimport dompurify from 'dompurify';\n\nfunction searchResultHTML(stores) {\n    return stores.map(store => {\n        return `\n        <a href=\"/store/${store.slug}\" class=\"search__result\">\n            <strong>${store.name}</strong>\n        </a>\n        `;\n    }).join('');\n};\n\nfunction typeAhead(search) {\n    if(!search) return;\n\n    const searchInput = search.querySelector('input[name=\"search\"]');\n    const searchResults = search.querySelector('.search__results');\n\n    searchInput.on('input', function () {\n        // if there is no value^quit it!\n        if(!this.value) {\n            searchResults.style.display = 'none';\n            return; // stop!\n        }\n\n        // show the search results!\n        searchResults.style.display = 'block';\n\n\n        axios\n            .get(`/api/search?q=${this.value}`)\n            .then(res => {\n                if(res.data.length) {\n                    searchResults.innerHTML = dompurify.sanitize(searchResultHTML(res.data));\n                    return;\n                } else {\n                    // tell them nothing came back\n                    searchResults.innerHTML = dompurify.sanitize(`<div class =\"search__result\">No results for ${this.value} found!</div>`);\n                }\n            })\n            .catch(err => {\n                console.error(err);\n            });\n    });\n\n    // handle keyboard inputs\n    searchInput.on('keyup', (e) => {\n        // if they aren't pressing up, down or enter, who cares!\n        if(![38,40,13].includes(e.keyCode)) {\n            return; // skip it!\n        }\n        const activeClass = 'search__result--active';\n        const current = search.querySelector(`.${activeClass}`);\n        const items = search.querySelectorAll('.search__result');\n        let next;\n        if(e.keyCode === 40 && current) {\n            next = current.nextElementSibling || items[0];\n        } else if (e.keyCode === 40){\n            next = items[0];\n        } else if (e.keyCode === 38 && current) {\n            next = current.previousElementSibling || items[items.length - 1];\n        } else if (e.keyCode === 38) {\n            next = items[items.length - 1];\n        } else if (e.keyCode === 13 && current.href) {\n            window.location = current.href;\n            return;\n        }\n        if(current) {\n            current.classList.remove(activeClass);\n        }\n        next.classList.add(activeClass);\n    });\n};\n\nexport default typeAhead;"]}